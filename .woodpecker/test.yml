---
when:
  - event: [pull_request, tag]
  - event: [push, manual]
    branch:
      - ${CI_REPO_DEFAULT_BRANCH}

steps:
  lint:
    image: docker.io/library/golang:1.21
    commands:
      - make lint

  test:
    image: docker.io/library/golang:1.21
    commands:
      - make test

  # coverage:
  #   image: docker.io/plugins/codecov
  #   settings:
  #     files:
  #       - coverage.out
  #     token:
  #       from_secret: codecov_token
